#!/usr/bin/env ruby
# Based on https://gist.github.com/gnarf/5406589

pr, branch = ARGV
remote = 'origin'


if pr.nil?
  puts "USAGE: git pr [REMOTE/]PR [BRANCH]"
  puts "\tgit pr 123"
  puts "\tgit pr upstream/123"
  puts "\tgit pr 123 branch"
  puts "\tgit pr upstream/123 branch"
  exit 1
end

if pr =~ /\//
  remote, pr = pr.split('/')
end

if branch.nil?
  branch = "pr/#{pr}"
end

exec("git fetch -fu #{remote} refs/pull/#{pr}/head:pr/#{pr} && git checkout -B #{branch} pr/#{pr}")
